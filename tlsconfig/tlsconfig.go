package tlsconfig

import (
	"crypto/tls"
	"crypto/x509"
)

func GetTLSConfig(clientCertPEMData, clientKeyPEMData []byte) (*tls.Config, error) {
	certPool := x509.NewCertPool()
	certPool.AppendCertsFromPEM([]byte(orchardCerts))

	clientCert, err := tls.X509KeyPair(clientCertPEMData, clientKeyPEMData)
	if err != nil {
		return nil, err
	}

	config := new(tls.Config)
	config.RootCAs = certPool
	config.Certificates = []tls.Certificate{clientCert}
	config.BuildNameToCertificate()

	return config, nil
}

var orchardCerts string = `-----BEGIN CERTIFICATE-----
MIIDizCCAnOgAwIBAgIJANOkcdAljaXsMA0GCSqGSIb3DQEBBQUAMFwxCzAJBgNV
BAYTAkdCMQ8wDQYDVQQIDAZMb25kb24xIjAgBgNVBAoMGU9yY2hhcmQgTGFib3Jh
dG9yaWVzIEx0ZC4xGDAWBgNVBAMMD09yY2hhcmQgUm9vdCBDQTAeFw0xMzA5MTAx
OTU4MDZaFw0xODA5MDkxOTU4MDZaMFwxCzAJBgNVBAYTAkdCMQ8wDQYDVQQIDAZM
b25kb24xIjAgBgNVBAoMGU9yY2hhcmQgTGFib3JhdG9yaWVzIEx0ZC4xGDAWBgNV
BAMMD09yY2hhcmQgUm9vdCBDQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC
ggEBAKE2uHYhJyUxTa/DgXE2Ru85RJptv7YypqL6/hEthhSb30e8c/UZ2RGAupgr
2KhP2B/c78d7hMIX09rbc/Z7TpnV4T3ERuguDJ6jz6NjLKDsW8VVBMx4imcE0hHB
ZrhO+cEuBBufw+iW83uNIkzzIVVlgZ6o9jGXEY61D+SNNxtsMEIkjh+5/JxdeRvK
PSHhBJ2VJpCRWpvuhEuCc5Qlz6PkWEbCchEe8Mzy6Zy8FzT4q4t+ztryWTUavR9s
8lv3N7vHMo4R/r1M+VtjlXzutV8S83avrUQ48woTGBULyfXisbSN6snCXf4VJx8E
UU48FjQBZbKfgV+2ut4f2oUdkNsCAwEAAaNQME4wHQYDVR0OBBYEFBM7bwyZ7n42
9q3EmgaOU7PGa4xtMB8GA1UdIwQYMBaAFBM7bwyZ7n429q3EmgaOU7PGa4xtMAwG
A1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBADZ5YUYc3WfiKWg1VqmBj0EE
wVhy43rId0ruMwcNgyDesCvIDJy5Y9XsIRnRIIeM3tm0MF+fGlmOiN1AvX0KeiTM
7RtPYFawl62aGrDvo0CdZTxCYSRcLvUhgGiftEnqRijawecnk5BhcP+g5Zxe8b+L
DzqbCwG9AQ9M2NAxWdbaBJwAL8qceKklVGWOEpjEYiF4zdNQoLfW+lygVBvKZEwF
By4x8aTPlf8MMMn2ogk4Js8ZcjmvP9fBlA09ecD1DO9lNWMXpDyoB504qTPGoLoj
u6XKHvAXEXvMzLHp7qABqZXDgKIcr8wAqnmqlnFHpLjd+bV7bGMHjGM8EeIdt8I=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIDlzCCAn+gAwIBAgIJANOkcdAljaXuMA0GCSqGSIb3DQEBBQUAMFwxCzAJBgNV
BAYTAkdCMQ8wDQYDVQQIDAZMb25kb24xIjAgBgNVBAoMGU9yY2hhcmQgTGFib3Jh
dG9yaWVzIEx0ZC4xGDAWBgNVBAMMD09yY2hhcmQgUm9vdCBDQTAeFw0xMzA5MTAy
MDQwMjNaFw0xODA5MDkyMDQwMjNaMGgxCzAJBgNVBAYTAkdCMQ8wDQYDVQQIDAZM
b25kb24xIjAgBgNVBAoMGU9yY2hhcmQgTGFib3JhdG9yaWVzIEx0ZC4xJDAiBgNV
BAMMG09yY2hhcmQgRGV2ZWxvcG1lbnQgSG9zdCBDQTCCASIwDQYJKoZIhvcNAQEB
BQADggEPADCCAQoCggEBAJzy3YazgY7u9UzWtcp+dNmaHuha+DiuRkn117K2JJMH
Pk77j/9E+rEVFVe2h3MhVpFkHK+emkpclDggNurAytvnP5vFSQzCirpMPMiQfrCX
g9Idue325A7fHQSG6iN95drVJ3Oe2Ytlk9ctwWmUjNkwIicvsdbCwHg79OsbcmuK
mceJdmvW8Jwb1BpUOaJBlZKEdTdFmWpIhmIU/dN4UBdDEfaD0IHdOuwOGyQUodBT
0dl+jeiDa7OuP+C4JsL4NTD1jOKROKgh99xOaOZFDBx8jofGsxvLk37gPoEYz/KH
gARi5z4RKSUntSIQ/1ZPwdDkLkGykUi7usr5MP8rWmkCAwEAAaNQME4wHQYDVR0O
BBYEFLtGwhHnW982Sr65v5R4OGWF7HqEMB8GA1UdIwQYMBaAFBM7bwyZ7n429q3E
mgaOU7PGa4xtMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBAA/a21Qr
A8U6DGJnq48CFxE/XmSedPZBEQKjUTwhGQ0Y20/z7H3hQZT0p9VcZPchDg5SNc90
X7tjNYQi2r9TJuzNlYNX9eFYH7F1qzw7SkfYRCZEcfUANpFRMy2h3bZP/cjPmGZz
96Pjc0u1KbijTDXswu0gaCevaHQ+H9NfEYXFptJ4ouhR9wPKGc7CKWmWwF8+qYDP
EM7zpJ6oQqeCMk+YU48VXSe5f0hUDCF5wk+b/M7vpDFAqakt5PPltFLNXidDuzPl
1CmtxFFuniKQSg2BGiyNQ+PxSRm8fTIEx2lmxDCIwWtJFAktW/U2rzPzKiu2DIsf
IzmWBNhs26Q6sS4=
-----END CERTIFICATE-----`
